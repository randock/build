<?xml version="1.0" encoding="UTF-8"?>
<project name="common-bundle" default = "validate">
    <import file="build.base.xml"/>

    <!-- Executes QA tools: phpmetrics, phpmd and phpcpd -->
    <target name="phpqa"
            unless="phpqa.done"
            description="Execute quality assurance commands.">

        <dirname property="ant.dir" file="${ant.file}" />

        <exec executable="${phpqa.binary}" resultproperty="result.phpqa" taskname="phpqa">
            <arg value="--tools" />
            <arg value="phpmetrics,phpmd,phpcpd,phpstan:0,parallel-lint:0" />
            <arg value="--report" />
            <arg value="--ignoredDirs" />
            <arg value="vendor,bin,var,web,app,tests" />
            <arg value="--analyzedDirs" />
            <arg value="src" />
            <arg value="--buildDir" />
            <arg path="${basedir}/build" />

        </exec>

        <property name="phpqa.done" value="true"/>
    </target>

</project>
